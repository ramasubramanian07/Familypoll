<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Arun & Subbu's Baby Poll</title>
<script src="https://cdn.tailwindcss.com"></script>

<style>
@keyframes leftHeart { 0% { transform: translateX(-120%); opacity: 0; } 100% { transform: translateX(0); opacity: 0.8; } }
@keyframes rightHeart { 0% { transform: translateX(120%); opacity: 0; } 100% { transform: translateX(0); opacity: 0.8; } }
@keyframes pulseSoft { 0%,100% { transform: scale(1); } 50% { transform: scale(1.08); } }

.heart-bg { position: absolute; top: 55%; z-index: -1; font-size: 120px; filter: blur(2px); }

.boy-btn {
  color: #2563eb;
}
.boy-btn:hover {
  background:#1e40af;
  color:white;
  transform: scale(1.15);
}
.girl-btn {
  color:#ec4899;
}
.girl-btn:hover {
  background:#be185d;
  color:white;
  transform: scale(1.15);
}

.selected-boy {
  background:#1e3a8a !important;
  color:white !important;
  transform: scale(1.25);
  box-shadow: 0 0 0 6px rgba(37,99,235,0.3);
}
.selected-girl {
  background:#9d174d !important;
  color:white !important;
  transform: scale(1.25);
  box-shadow: 0 0 0 6px rgba(236,72,153,0.3);
}

#submitStatus {
  display:none;
}
</style>
</head>

<body class="bg-pink-50 font-sans overflow-x-hidden">

<!-- INTRO -->
<div id="intro-overlay" class="fixed inset-0 z-50 flex items-center justify-center bg-gradient-to-r from-pink-300 to-orange-200">
  <div class="text-center">
    <h1 class="text-5xl font-extrabold text-white">Arunprasad & Subbulakshmi</h1>
    <p class="text-white mt-4 italic">Waiting for our little miracle...</p>
  </div>
</div>

<main id="main-content" class="hidden min-h-screen flex flex-col items-center justify-center p-6">
  <h2 class="text-4xl font-bold text-pink-600 mb-8">Family Prediction Poll</h2>
  <button onclick="showPage('voting-page')" class="bg-blue-400 text-white py-6 px-10 rounded-3xl text-2xl font-bold mb-4">üó≥Ô∏è Vote</button>
  <button onclick="showPage('login-page')" class="bg-purple-400 text-white py-6 px-10 rounded-3xl text-2xl font-bold">üîê Admin</button>
</main>

<!-- VOTING -->
<section id="voting-page" class="hidden min-h-screen flex items-center justify-center p-6">
<div class="bg-white p-8 rounded-3xl shadow-2xl w-full max-w-md">

<h3 class="text-2xl font-bold text-center text-blue-500 mb-4 italic flex justify-center items-center gap-2">
  üë£ Arunprasad & Subbulakshmi üë£
</h3>

<input id="vName" placeholder="Your Name" class="w-full p-4 border rounded-2xl mb-4">
<input id="vRelation" placeholder="Relation to Couple" class="w-full p-4 border rounded-2xl mb-6">

<p class="text-center font-bold mb-4">What's your guess?</p>

<div class="flex justify-around mb-8">
  <button id="btn-boy" onclick="pick('BOY')" class="boy-btn text-6xl p-4 rounded-full transition-all">üë¶</button>
  <button id="btn-girl" onclick="pick('GIRL')" class="girl-btn text-6xl p-4 rounded-full transition-all">üëß</button>
</div>

<button id="submitBtn" onclick="handleVote()" class="w-full bg-gradient-to-r from-blue-500 to-pink-500 text-white font-bold py-4 rounded-2xl">
Submit Vote
</button>

<p id="submitStatus" class="text-center mt-4 font-bold text-green-500 animate-pulse">Submitting your vote...</p>

</div>
</section>

<script>
let currentPick = "";
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbwQiZxUE6Q0HJzFUeEMU9Rudz9THuEiIULOX61O6NlGp4FcS3F-vH6QERs4trIeTgO_lA/exec";

setTimeout(() => {
 document.getElementById('intro-overlay').style.display='none';
 document.getElementById('main-content').classList.remove('hidden');
},3000);

function showPage(id){
 document.querySelectorAll('main,section').forEach(e=>e.classList.add('hidden'));
 document.getElementById(id).classList.remove('hidden');
}

function pick(val){
 currentPick=val;
 btnBoy.classList.remove('selected-boy');
 btnGirl.classList.remove('selected-girl');
 val==='BOY'?btnBoy.classList.add('selected-boy'):btnGirl.classList.add('selected-girl');
}

async function handleVote(){
 const btn=document.getElementById('submitBtn');
 const status=document.getElementById('submitStatus');

 if(!vName.value || !vRelation.value || !currentPick){
   alert("Fill all details");
   return;
 }

 btn.disabled=true;
 btn.innerText="Submitting...";
 status.style.display="block";

 try{
   const check=await fetch(SCRIPT_URL+'?action=getVotes');
   const votes=await check.json();
   if(votes.some(v=>v.name.toLowerCase()===vName.value.toLowerCase())){
     alert("Already voted");
     location.reload();
     return;
   }

   await fetch(SCRIPT_URL,{
     method:'POST',
     mode:'no-cors',
     body:JSON.stringify({action:'vote',name:vName.value,relation:vRelation.value,choice:currentPick})
   });

   alert("Vote submitted successfully üíñ");
   location.reload();
 }catch(e){
   alert("Network error");
 }
}
</script>
</body>
</html>
